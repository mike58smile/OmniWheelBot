\hypertarget{_drive_8h_source}{}\doxysection{Drive.\+h}
\mbox{\hyperlink{_drive_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*****************************************************************/}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef \_DRIVE\_h}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define \_DRIVE\_h}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#if defined(ARDUINO) \&\& ARDUINO >= 100}}
\DoxyCodeLine{14 \textcolor{preprocessor}{    \#include "{}arduino.h"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16 \textcolor{preprocessor}{    \#include "{}WProgram.h"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <timer.h>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{comment}{//\#define ENCODER\_OPTIMIZE\_INTERRUPTS}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <Encoder.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <PID\_v1.h>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_state_8h}{State.h}}"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_motors_8h}{Motors.h}}"{}}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{_drive_8h_aabb5eb13d6075d416b5e86c1b6a285ad}{SpeedRampDelayCalib}} = 80; }
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{enum class} CalibState \{ Init, Motor1\_f, Motor1\_b, Motor2\_f, Motor2\_b, End,   Size \}; }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define calibStatePrint CalibStatePrint[static\_cast<int>(calibState)] }}
\DoxyCodeLine{33 \textcolor{keyword}{class }\mbox{\hyperlink{class_drive_class}{DriveClass}} final}
\DoxyCodeLine{34 \{}
\DoxyCodeLine{35  \textcolor{keyword}{private}:}
\DoxyCodeLine{36      CalibState calibState = CalibState::Init; }
\DoxyCodeLine{37      \mbox{\hyperlink{class_motors_class}{MotorsClass}} Motors\{\}; }
\DoxyCodeLine{38      Timer timer; }
\DoxyCodeLine{39       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} currentTime; }
\DoxyCodeLine{40      \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} previousTime; }
\DoxyCodeLine{41 }
\DoxyCodeLine{42      \textcolor{comment}{//Ramp init variables}}
\DoxyCodeLine{43      \textcolor{keywordtype}{bool} rampInitDone[2] = \{ 0,0 \}; }
\DoxyCodeLine{44      Timer Timer\_ramp1; }
\DoxyCodeLine{45      Timer Timer\_ramp2; }
\DoxyCodeLine{46      Timer* Timer\_ramp[2] = \{ \&Timer\_ramp1, \&Timer\_ramp2 \};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48      \textcolor{keywordtype}{bool} accTillRotatingDone[2] = \{ 0, 0 \};}
\DoxyCodeLine{49      \textcolor{keywordtype}{bool} deccTillRotatingDone[2] = \{ 0, 0 \};}
\DoxyCodeLine{50      \textcolor{keyword}{struct }calibData \{}
\DoxyCodeLine{51          \textcolor{keywordtype}{bool} endCalib = \textcolor{keyword}{false};}
\DoxyCodeLine{52          \textcolor{keywordtype}{int} endSpeedPWM = 0;}
\DoxyCodeLine{53          \textcolor{keywordtype}{float} endRealSpeed = 0;}
\DoxyCodeLine{54      \};}
\DoxyCodeLine{55 }
\DoxyCodeLine{60      \textcolor{keywordtype}{void} read();}
\DoxyCodeLine{61 }
\DoxyCodeLine{62      \textcolor{comment}{//DeadbandCalib}}
\DoxyCodeLine{63      \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} currentTime\_C = 0, previousTime\_C = 0; }
\DoxyCodeLine{64  \textcolor{keyword}{public}:}
\DoxyCodeLine{65      \textcolor{keywordtype}{double} pid\_Set1 = 0, pid\_In1 = 0, \mbox{\hyperlink{class_drive_class_a029425aedf46cfd45533255750ea5fa2}{pid\_Out1}} = 0; }
\DoxyCodeLine{66      \textcolor{keywordtype}{double} pid\_Set2 = 0, pid\_In2 = 0, \mbox{\hyperlink{class_drive_class_a3644e3c2fbbf291a54ba3875a9d8d859}{pid\_Out2}} = 0; }
\DoxyCodeLine{67 }
\DoxyCodeLine{68      \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{class_drive_class_a755328156bfeed91c73655ec3b1a26fa}{CalibStatePrint}}[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(CalibState::Size)] = \{ \textcolor{stringliteral}{"{}Init"{}}, \textcolor{stringliteral}{"{}Motor1\_f"{}}, \textcolor{stringliteral}{"{}Motor1\_b"{}}, \textcolor{stringliteral}{"{}Motor2\_f"{}}, \textcolor{stringliteral}{"{}Motor2\_b"{}}, \textcolor{stringliteral}{"{}End"{}} \}; }
\DoxyCodeLine{69      PID \mbox{\hyperlink{class_drive_class_adc25d7e18fba0c6faa7bbc1e4a071a58}{pid1}}; }
\DoxyCodeLine{70      PID \mbox{\hyperlink{class_drive_class_a1522b8234dfaea99d1d77e4730fe895f}{pid2}}; }
\DoxyCodeLine{71      Encoder \mbox{\hyperlink{class_drive_class_a220a780cced6ece3e94731bd9cefd850}{enc1}}; }
\DoxyCodeLine{72      Encoder \mbox{\hyperlink{class_drive_class_a105582a5f5109076eb59d3556db0d428}{enc2}}; }
\DoxyCodeLine{73 }
\DoxyCodeLine{79      \mbox{\hyperlink{class_drive_class_aef5772bb8a2193ea69c6a55b25850887}{DriveClass}}() : \mbox{\hyperlink{class_drive_class_a220a780cced6ece3e94731bd9cefd850}{enc1}}(State.Enc1\_1, State.Enc1\_2), \mbox{\hyperlink{class_drive_class_a105582a5f5109076eb59d3556db0d428}{enc2}}(State.Enc2\_1, State.Enc2\_2),}
\DoxyCodeLine{80      \mbox{\hyperlink{class_drive_class_adc25d7e18fba0c6faa7bbc1e4a071a58}{pid1}}(\&pid\_In1, \&\mbox{\hyperlink{class_drive_class_a029425aedf46cfd45533255750ea5fa2}{pid\_Out1}}, \&pid\_Set1, State.Kp\_1, State.Ki\_1, State.Kd\_1, DIRECT), \mbox{\hyperlink{class_drive_class_a1522b8234dfaea99d1d77e4730fe895f}{pid2}}(\&pid\_In2, \&\mbox{\hyperlink{class_drive_class_a3644e3c2fbbf291a54ba3875a9d8d859}{pid\_Out2}}, \&pid\_Set2, State.Kp\_2, State.Ki\_2, State.Kd\_2, DIRECT)\{\}}
\DoxyCodeLine{81      }
\DoxyCodeLine{86      \textcolor{keywordtype}{void} \mbox{\hyperlink{class_drive_class_af058246867930180e2e73d98d94075e9}{init}}();}
\DoxyCodeLine{87 }
\DoxyCodeLine{92      \textcolor{keywordtype}{void} \mbox{\hyperlink{class_drive_class_a37365361d8fc1a2e99526602670a4e8a}{loop}}();}
\DoxyCodeLine{93 }
\DoxyCodeLine{94      \textcolor{keywordtype}{void} rampInit(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{int} TimeSlope, \textcolor{keywordtype}{int} SpeedBegin = 0);}
\DoxyCodeLine{95      \textcolor{keywordtype}{void} rampUpdate(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{int} increment);}
\DoxyCodeLine{96      \textcolor{keywordtype}{void} AccTillRotating\_init(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{int} TimeSlope);}
\DoxyCodeLine{97      \textcolor{keywordtype}{bool} AccTillRotating\_update(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{int} increment, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} endSpeed = 0);}
\DoxyCodeLine{98      }
\DoxyCodeLine{99      \textcolor{keywordtype}{void} DeccTillRotating\_init(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{int} timeSlope, \textcolor{keywordtype}{int} speedBegin = 0);}
\DoxyCodeLine{100      \textcolor{keywordtype}{bool} DeccTillRotating\_update(\textcolor{keywordtype}{bool} motSelect, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} decrement, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} endSpeed = 0);}
\DoxyCodeLine{101 }
\DoxyCodeLine{102      \textcolor{keywordtype}{bool} CalibDeadband();}
\DoxyCodeLine{103 \};}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{keyword}{extern} \mbox{\hyperlink{class_drive_class}{DriveClass}} Drive;}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
