\hypertarget{_state_8h_source}{}\doxysection{State.\+h}
\mbox{\hyperlink{_state_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*****************************************************************/}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#ifndef \_STATE\_h}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define \_STATE\_h}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#if defined(ARDUINO) \&\& ARDUINO >= 100}}
\DoxyCodeLine{14 \textcolor{preprocessor}{    \#include "{}arduino.h"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16 \textcolor{preprocessor}{    \#include "{}WProgram.h"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{comment}{/*************************************************** Setup variables *********************************************************************/}}
\DoxyCodeLine{20 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{_state_8h_af1ee17c0956f0fbad7ddac68c0a7bdc8}{maxSpeed}} = 220; }
\DoxyCodeLine{21 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{_state_8h_a19b74d5ea8b2d5e4bd7afd11f8a5dde5}{TimerSpeedDelay\_mS}} = 20; }
\DoxyCodeLine{22 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{_state_8h_a44bd00b454e4a42cbf517b3221c5f118}{Address}} = 0x10;}
\DoxyCodeLine{23 \textcolor{comment}{/*****************************************************************************************************************************************/}}
\DoxyCodeLine{24 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{_state_8h_a22bfcbace3609c2784ea6cef76982799}{TimerSpeedDelay\_uS}} = \mbox{\hyperlink{_state_8h_a19b74d5ea8b2d5e4bd7afd11f8a5dde5}{TimerSpeedDelay\_mS}} * 1000; }
\DoxyCodeLine{25 \textcolor{keyword}{const} \textcolor{keywordtype}{float} \mbox{\hyperlink{_state_8h_a5cdc0c0d93cbc298c134fef161834b8c}{num}} = TWO\_PI / (979.2 * (\mbox{\hyperlink{_state_8h_a19b74d5ea8b2d5e4bd7afd11f8a5dde5}{TimerSpeedDelay\_mS}} / 1000.0));}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{inline} \textcolor{keywordtype}{float} \mbox{\hyperlink{_state_8h_a69d4b58df7198b25a6b25265f8199e73}{EncToRealSpd}}(\textcolor{keywordtype}{int} EncSpeed) \{}
\DoxyCodeLine{28     \textcolor{keywordflow}{return}(\textcolor{keywordtype}{float}(EncSpeed) * \mbox{\hyperlink{_state_8h_a5cdc0c0d93cbc298c134fef161834b8c}{num}});}
\DoxyCodeLine{29 \}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{static} \textcolor{keyword}{inline} int8\_t sign(\textcolor{keywordtype}{int} val) \{}
\DoxyCodeLine{32     \textcolor{keywordflow}{if} (val < 0) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{33     \textcolor{keywordflow}{if} (val == 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{34     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{35 \}}
\DoxyCodeLine{36 \textcolor{comment}{// User defined data types:}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keyword}{using }\mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} = \textcolor{keyword}{const} uint8\_t;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{\#define printState\_comm stateArr\_comm[static\_cast<int>(State.state\_comm)] }\textcolor{comment}{//inline function is much better}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define printState\_commPrev stateArr\_comm[static\_cast<int>(State.state\_commPrev)] }\textcolor{comment}{//inline function is much better}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define printState\_actual stateArr\_actual[static\_cast<int>(State.state\_actual)] }\textcolor{comment}{//inline function is much better}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define printState\_measType stateArr\_measType[static\_cast<int>(State.meas.state\_measType)] }\textcolor{comment}{//inline function is much better}}
\DoxyCodeLine{45      }
\DoxyCodeLine{46 \textcolor{keyword}{enum class} \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aaf}{State\_measType}} \{ \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa5bc58795743463cbb3c7c681702501b9}{Calib}}, \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa99b4c3afc6aaa3ab4de17c90455a55eb}{Ramp}}, \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa8cfc7840e76e78c256edd05f78481001}{Ramp\_optim}},   \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa6f6cb72d544962fa333e2e34ce64f719}{Size}} \}; }
\DoxyCodeLine{47 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* stateArr\_measType[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa6f6cb72d544962fa333e2e34ce64f719}{State\_measType::Size}})] = \{ \textcolor{stringliteral}{"{}Calib"{}}, \textcolor{stringliteral}{"{}Ramp"{}}, \textcolor{stringliteral}{"{}Ramp\_optim"{}} \}; }
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{keyword}{enum class} \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060}{State\_actual}} \{ \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060aad2376beebecdcf7846ba973fa1a005b}{Setup}}, \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060a44877c6aa8e93fa5a91c9361211464fb}{Speed}}, \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060a11a755d598c0c417f9a36758c3da7481}{Stop}}, \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa6f6cb72d544962fa333e2e34ce64f719}{Size}} \}; }
\DoxyCodeLine{50 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* stateArr\_actual[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060a6f6cb72d544962fa333e2e34ce64f719}{State\_actual::Size}})] = \{ \textcolor{stringliteral}{"{}Setup"{}}, \textcolor{stringliteral}{"{}Speed"{}}, \textcolor{stringliteral}{"{}Stop"{}} \}; }
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{enum class} \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9}{State\_comm}} \{ \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060a11a755d598c0c417f9a36758c3da7481}{Stop}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a0f68101772bd5397ef8eb1b632798652}{Wait}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a46d484d926406a0d3dd2a86767c7283d}{SpeedPWM}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a1b8a4411e3a31abbd3cb3bce98e432e0}{SpeedReal}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a1dbf2f01da50255b56f890498e902974}{ChangeConstPID}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9add6c37949021ae4a61488edd216ff6a4}{CalibDeadBand}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a88183b946cc5f0e8c96b2e66e1c74a7e}{Unknown}}, \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a98755957728862eda815b91a57c6f1dd}{Meas}}, \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aafa6f6cb72d544962fa333e2e34ce64f719}{Size}} \}; }
\DoxyCodeLine{53 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* stateArr\_comm[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9a6f6cb72d544962fa333e2e34ce64f719}{State\_comm::Size}})] = \{ \textcolor{stringliteral}{"{}Stop"{}}, \textcolor{stringliteral}{"{}Wait"{}}, \textcolor{stringliteral}{"{}SpeedPWM"{}}, \textcolor{stringliteral}{"{}SpeedReal"{}}, \textcolor{stringliteral}{"{}ChangeConstPID"{}}, \textcolor{stringliteral}{"{}CalibDeadBand"{}}, \textcolor{stringliteral}{"{}Unknown"{}} \}; }
\DoxyCodeLine{54 }
\DoxyCodeLine{58 \textcolor{keyword}{class }\mbox{\hyperlink{class_state_class}{StateClass}}}
\DoxyCodeLine{59 \{}
\DoxyCodeLine{60  \textcolor{keyword}{public}:}
\DoxyCodeLine{61      \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_add9036be5fc71d613818f077e994a890}{address}} = \mbox{\hyperlink{_state_8h_a44bd00b454e4a42cbf517b3221c5f118}{Address}}; }
\DoxyCodeLine{62 }
\DoxyCodeLine{63      \mbox{\hyperlink{_state_8h_a828d9bb3c8299c92aea1c61a5760c060}{State\_actual}} \mbox{\hyperlink{class_state_class_a972d83bba03c1d5fab9d591cf90413af}{state\_actual}} = State\_actual::Setup; }
\DoxyCodeLine{64      \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9}{State\_comm}} \mbox{\hyperlink{class_state_class_a3e766ab473beb2d78957ea1e56a5496c}{state\_comm}} = State\_comm::Stop; }
\DoxyCodeLine{65      \mbox{\hyperlink{_state_8h_a5556f0a55b3d74e6c6488a16761e63e9}{State\_comm}} \mbox{\hyperlink{class_state_class_a9eec6ce9f920b889a4a0c8c02c022a93}{state\_commPrev}} = State\_comm::Stop; }
\DoxyCodeLine{66      }
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{comment}{// Regulator parameters}}
\DoxyCodeLine{69      \textcolor{keywordtype}{double} \mbox{\hyperlink{class_state_class_aba4721f9cf041b18c3c55ab07d1422a8}{Kp\_1}} = 0.8, \mbox{\hyperlink{class_state_class_a2556544809340c960c0078fcabf26487}{Ki\_1}} = 8, \mbox{\hyperlink{class_state_class_a192af399e0e1edf8f7c5a70598c13206}{Kd\_1}} = 0; }
\DoxyCodeLine{70      \textcolor{keywordtype}{double} \mbox{\hyperlink{class_state_class_afc2f36adc48bfa088a24426d537a8dc9}{Kp\_2}} = 0.8, \mbox{\hyperlink{class_state_class_a334cea4cfd61e58255558f1a9c62f437}{Ki\_2}} = 8, \mbox{\hyperlink{class_state_class_a9cbed008c5caff5f2c4a3f97ae4dfa32}{Kd\_2}} = 0; }
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{comment}{// Define pins}}
\DoxyCodeLine{73      \textcolor{comment}{//Motor1}}
\DoxyCodeLine{74      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_af16be3bdd352108b7e52b9b300426f8a}{M1\_LPWM}} = 5;}
\DoxyCodeLine{75      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a47c9036fe4870e6fde16dd6f38193bd4}{M1\_RPWM}} = 6;}
\DoxyCodeLine{76      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a156fcf286de2fdf99c872d6608dff63c}{M1\_REN}} = 4;}
\DoxyCodeLine{77      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_ab96e1530e232f39c448d858542f7bf1b}{M1\_LEN}} = 7;}
\DoxyCodeLine{78      \textcolor{comment}{//Motor2}}
\DoxyCodeLine{79      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a1fc7cb0bd50e37191b2dbd79170dd717}{M2\_RPWM}} = 10;}
\DoxyCodeLine{80      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a1fbf971a698983c471cf6bf43dc8f15a}{M2\_LPWM}} = 11;}
\DoxyCodeLine{81      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_adc78988989cc925ec01ebc53b655255f}{M2\_REN}} = 8;}
\DoxyCodeLine{82      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a1ca40a1d19e74952e21cda379b408a98}{M2\_LEN}} = 9;}
\DoxyCodeLine{83      \textcolor{comment}{//define Encoder pins}}
\DoxyCodeLine{84      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a7538052f153935d19e0a9e5f1dbd62f7}{Enc1\_1}} = 2;}
\DoxyCodeLine{85      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_af7e624f28c7c7e8a442a0be613b27b94}{Enc1\_2}} = 12;}
\DoxyCodeLine{86      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a43a2fd8c7bd4ffc767461ce028512431}{Enc2\_1}} = 3;}
\DoxyCodeLine{87      \textcolor{keyword}{static} \mbox{\hyperlink{_state_8h_a2702e3b6e878a8f76c96dc3d7b49a06d}{Pin}} \mbox{\hyperlink{class_state_class_a16f9246d7cbbeead1757af3b72b56e26}{Enc2\_2}} = A0;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 }
\DoxyCodeLine{90 }
\DoxyCodeLine{91      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_a5ac9eef8d2090a6339f349a3bb78aa49}{motor1DeadBandPWM}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{92      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_ae0cb1fa57240aeece9e15b302e909530}{motor2DeadBandPWM}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{93      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_afc7517372f0c836ea25c5eb441c6177f}{motorDeadBandPWM}}[2] = \{ 0, 0 \};}
\DoxyCodeLine{94      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_a80224cd0333fc8c57507fd3c126dda96}{motor1DeadBandReal}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{95      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_a21f7edb723246a6d12b225928c8edeb2}{motor2DeadBandReal}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{96      \textcolor{comment}{//float motorDeadBandReal[2] = \{ 0, 0 \};}}
\DoxyCodeLine{97      \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_state_class_ab1e985ffb2b291bd0d296394fccaaff5}{CalibEnd}} = 0;  }
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{comment}{// Non const variables -\/ will be changed during program}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_a37816025e4f99f25401ae08862a660c9}{actualSpeed}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{102      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_ad35700f8b8ec016a81c9b9ff2f049791}{requiredSpeed}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{103      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_a22e8e7efc4b25e9c8c117607768a23b6}{actualEncSpeed}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{104      \textcolor{keywordtype}{int} \mbox{\hyperlink{class_state_class_aca81ce882f72fc7b4de88632272fc754}{requiredEncSpeed}}[2] = \{ 0,0 \};}
\DoxyCodeLine{105      \textcolor{keywordtype}{float} \mbox{\hyperlink{class_state_class_a262f7357126ca5e0bc0c12c7243df553}{actualRealSpeed}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{106      \textcolor{keywordtype}{float} \mbox{\hyperlink{class_state_class_a78697ac64c2a18d1d3885fc5ce29178a}{requiredRealSpeed}}[2] = \{ 0,0 \}; }
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{comment}{// Measurements variables:}}
\DoxyCodeLine{112 \textcolor{comment}{}     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_state_class_1_1_meas}{Meas}} \{}
\DoxyCodeLine{113          \mbox{\hyperlink{_state_8h_a1a7dcd795684bd7e6ae6768721747aaf}{State\_measType}} \mbox{\hyperlink{struct_state_class_1_1_meas_af98b6703a5a62cd7459eddd9fed3877e}{state\_measType}}; }
\DoxyCodeLine{114          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{struct_state_class_1_1_meas_a1eac1ac7feda1471bbe85a2edceadf13}{motSelect}} = 0; }
\DoxyCodeLine{115          \textcolor{keywordtype}{int} \mbox{\hyperlink{struct_state_class_1_1_meas_a36cddf1b969111c010899836492d1f1e}{temp}} = 0; }
\DoxyCodeLine{116      \} \mbox{\hyperlink{class_state_class_af71942d5a7ee612dfa4ca7883392dd83}{meas}};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118      \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_state_class_abfef7b427ef851b42ca9b508481a7cd1}{readSpeed}} = 0; }
\DoxyCodeLine{119 \};}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{keyword}{extern} \mbox{\hyperlink{class_state_class}{StateClass}} \mbox{\hyperlink{_state_8h_aa0cc817b371dc08979042179019be7da}{State}};}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \textcolor{comment}{//Garbage}}
\DoxyCodeLine{162 \textcolor{comment}{}\textcolor{comment}{/* Garbage:}}
\DoxyCodeLine{163 \textcolor{comment}{* }}
\DoxyCodeLine{164 \textcolor{comment}{* //\#define USE\_TIMER\_2 true //Use before TimerInterrupt library included -\/ defines which timer to use for interrupts (but it isn't working with Encoders)}}
\DoxyCodeLine{165 \textcolor{comment}{* }}
\DoxyCodeLine{166 \textcolor{comment}{* inline static const char* printState\_measType() \{}}
\DoxyCodeLine{167 \textcolor{comment}{    return stateArr\_measType[static\_cast<int>(State.meas.state\_measType)];}}
\DoxyCodeLine{168 \textcolor{comment}{\}}}
\DoxyCodeLine{169 \textcolor{comment}{inline static const char* printState\_actual() \{}}
\DoxyCodeLine{170 \textcolor{comment}{ return stateArr\_actual[static\_cast<int>(State.state\_actual)];}}
\DoxyCodeLine{171 \textcolor{comment}{\}}}
\DoxyCodeLine{172 \textcolor{comment}{inline static const char* printState\_comm() \{}}
\DoxyCodeLine{173 \textcolor{comment}{ return stateArr\_comm[static\_cast<int>(State.State.state\_comm)];}}
\DoxyCodeLine{174 \textcolor{comment}{\}}}
\DoxyCodeLine{175 \textcolor{comment}{* }}
\DoxyCodeLine{176 \textcolor{comment}{Initialization of static const array in .h file}}
\DoxyCodeLine{177 \textcolor{comment}{     static const uint8\_t Enc1Pin(size\_t index) \{}}
\DoxyCodeLine{178 \textcolor{comment}{         static const uint8\_t x[] = \{ 1,2 \};}}
\DoxyCodeLine{179 \textcolor{comment}{         return x[index];}}
\DoxyCodeLine{180 \textcolor{comment}{     \}}}
\DoxyCodeLine{181 \textcolor{comment}{*/}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{comment}{/* RPM Debounce}}
\DoxyCodeLine{184 \textcolor{comment}{ Relative to RPM readout and triggering to start  a thread path:}}
\DoxyCodeLine{185 \textcolor{comment}{}}
\DoxyCodeLine{186 \textcolor{comment}{  Index debounce will affect the sensitivity of the index signal. IT basically is how many interrupt periods the signal must be present, or not present before a change is actually sensed in that line. SO if set to 2 for example, when the index appears it will be ignored for 2 periods to make sure it isnt noise. Same with when it disappears. Setting debounce too high will make the index go away altogether.}}
\DoxyCodeLine{187 \textcolor{comment}{}}
\DoxyCodeLine{188 \textcolor{comment}{  Since the length of the index is dependent on spindle speed, minimum length is variable, but the time must be at least 1 period at a debounce of zero. SO in 25000, thats 40us.}}
\DoxyCodeLine{189 \textcolor{comment}{  If a person notices a dropoff in RPM at a certain speed, they need usually a lower index debounce. Index inputs from an encoder are usually pretty short and will limit speed readings at some point as you go higher.}}
\DoxyCodeLine{190 \textcolor{comment}{}}
\DoxyCodeLine{191 \textcolor{comment}{If you have the debounce setting too high the axis will just sit there waiting to confirm the rpm}}
\DoxyCodeLine{192 \textcolor{comment}{before the start of a thread path.}}
\DoxyCodeLine{193 \textcolor{comment}{}}
\DoxyCodeLine{194 \textcolor{comment}{Don't have specifics relative to switches .}}
\DoxyCodeLine{195 \textcolor{comment}{ */}}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{comment}{//READ spd with millis}}
\DoxyCodeLine{198 \textcolor{comment}{//     unsigned long currentMillis\_1 = 0;}}
\DoxyCodeLine{199 \textcolor{comment}{//     unsigned long previousMillis\_1 = 0;}}
\DoxyCodeLine{200 \textcolor{comment}{// }}
\DoxyCodeLine{201  \textcolor{comment}{//    currentMillis\_1 = millis();}}
\DoxyCodeLine{202  \textcolor{comment}{//    if ((currentMillis\_1 -\/ previousMillis\_1) >= 200) \{}}
\DoxyCodeLine{203  \textcolor{comment}{//        encSpeed[0] = abs(Drive.enc1.read());}}
\DoxyCodeLine{204  \textcolor{comment}{//        Drive.enc1.write(0);}}
\DoxyCodeLine{205  \textcolor{comment}{//        encSpeed[1] = abs(Drive.enc2.read());}}
\DoxyCodeLine{206  \textcolor{comment}{//        Drive.enc2.write(0);}}
\DoxyCodeLine{207  \textcolor{comment}{//;       previousMillis\_1 = currentMillis\_1;}}
\DoxyCodeLine{208  \textcolor{comment}{//    \}}}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \textcolor{comment}{// Using timer interrupt}}
\DoxyCodeLine{212 \textcolor{comment}{// INCLUDES}}
\DoxyCodeLine{213 \textcolor{comment}{// \#include <ISR\_Timer.h>}}
\DoxyCodeLine{214 \textcolor{comment}{//\#include <TimerInterrupt.hpp>}}
\DoxyCodeLine{215 \textcolor{comment}{//\#include <TimerInterrupt.h>}}
\DoxyCodeLine{216 \textcolor{comment}{//\#include <ISR\_Timer.hpp> }}
\DoxyCodeLine{217 }
\DoxyCodeLine{218 \textcolor{comment}{//SETUP:}}
\DoxyCodeLine{219 \textcolor{comment}{// Timer init}}
\DoxyCodeLine{220 \textcolor{comment}{//ITimer2.init();}}
\DoxyCodeLine{221 \textcolor{comment}{//if (ITimer2.attachInterruptInterval(TimerSpeedDelayMS, TimerSpeedHandler))}}
\DoxyCodeLine{222 \textcolor{comment}{//\{}}
\DoxyCodeLine{223 \textcolor{comment}{//    Serial.println(F("{}Starting  ITimer1 OK, millis() = "{})); Serial.println(millis());}}
\DoxyCodeLine{224 \textcolor{comment}{//\}}}
\DoxyCodeLine{225 \textcolor{comment}{//else}}
\DoxyCodeLine{226 \textcolor{comment}{//    Serial.println(F("{}Can't set ITimer1. Select another freq. or timer"{}));}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 \textcolor{comment}{//GLOBAL in .ino}}
\DoxyCodeLine{229 \textcolor{comment}{//Global variables}}
\DoxyCodeLine{230 \textcolor{comment}{//static volatile bool flagReadSpeed = 0; ///< Will be set true in interrupt routine}}
\DoxyCodeLine{231 \textcolor{comment}{//static volatile int interruptNum = 0; ///< Will increment in interrupt routine}}
\DoxyCodeLine{232 \textcolor{comment}{//void TimerSpeedHandler()}}
\DoxyCodeLine{233 \textcolor{comment}{//\{}}
\DoxyCodeLine{234 \textcolor{comment}{//    flagReadSpeed = 1;}}
\DoxyCodeLine{235 \textcolor{comment}{//    ++interruptNum;}}
\DoxyCodeLine{236 \textcolor{comment}{//\}}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 \textcolor{comment}{//In void loop:}}
\DoxyCodeLine{239 \textcolor{comment}{//if (flagReadSpeed) \{}}
\DoxyCodeLine{240 \textcolor{comment}{//    Drive.read();}}
\DoxyCodeLine{241 \textcolor{comment}{//    flagReadSpeed = 0;}}
\DoxyCodeLine{242 \textcolor{comment}{//    interruptNum = 0;}}
\DoxyCodeLine{243 \textcolor{comment}{//\}}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \textcolor{comment}{//In Drive.read:}}
\DoxyCodeLine{246 \textcolor{comment}{//State.encSpeed[0] = abs(enc1.read());}}
\DoxyCodeLine{247 \textcolor{comment}{//enc1.write(0);}}
\DoxyCodeLine{248 \textcolor{comment}{//State.encSpeed[1] = abs(enc2.read());}}
\DoxyCodeLine{249 \textcolor{comment}{//enc2.write(0);}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 \textcolor{comment}{//In Comm::RequestEvent:}}
\DoxyCodeLine{252 \textcolor{comment}{//char strBuffer[7];}}
\DoxyCodeLine{253 \textcolor{comment}{//Wire.write(dtostrf(State.actualRealSpeed[0], 7, 2, strBuffer)); //!odskusat ci funguje}}
\DoxyCodeLine{254 \textcolor{comment}{//Wire.write(dtostrf(State.actualRealSpeed[1], 7, 2, strBuffer));//!odskusat ci funguje  }}
\DoxyCodeLine{255 }
\DoxyCodeLine{256 \textcolor{comment}{//RAMP:}}
\DoxyCodeLine{257 \textcolor{comment}{//bool ramp(int motor, int beginPWM = 0, float slope = 1);}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259 \textcolor{comment}{//Motors Speed:}}
\DoxyCodeLine{261 \textcolor{comment}{}\textcolor{comment}{//if (Spd1 <= 0) \{}}
\DoxyCodeLine{262 \textcolor{comment}{//    analogWrite(State.M1\_LPWM, 0);}}
\DoxyCodeLine{263 \textcolor{comment}{//    analogWrite(State.M1\_RPWM, abs(Spd1));}}
\DoxyCodeLine{264 \textcolor{comment}{//\}}}
\DoxyCodeLine{265 \textcolor{comment}{//else\{}}
\DoxyCodeLine{266 \textcolor{comment}{//    analogWrite(State.M1\_RPWM, 0);}}
\DoxyCodeLine{267 \textcolor{comment}{//    analogWrite(State.M1\_LPWM, abs(Spd1));}}
\DoxyCodeLine{268 \textcolor{comment}{//\}}}
\DoxyCodeLine{269 }
\DoxyCodeLine{271 \textcolor{comment}{//if (Spd2 <= 0) \{}}
\DoxyCodeLine{272 \textcolor{comment}{//    analogWrite(State.M2\_LPWM, 0);}}
\DoxyCodeLine{273 \textcolor{comment}{//    analogWrite(State.M2\_RPWM, abs(Spd2));}}
\DoxyCodeLine{274 \textcolor{comment}{//\}}}
\DoxyCodeLine{275 \textcolor{comment}{//else \{}}
\DoxyCodeLine{276 \textcolor{comment}{//    analogWrite(State.M2\_RPWM, 0);}}
\DoxyCodeLine{277 \textcolor{comment}{//    analogWrite(State.M2\_LPWM, abs(Spd2));}}
\DoxyCodeLine{278 \textcolor{comment}{//\}}}
\DoxyCodeLine{279 \textcolor{comment}{//}}
\DoxyCodeLine{281 \textcolor{comment}{}\textcolor{comment}{//State.actualSpeed[0] = Spd1;}}
\DoxyCodeLine{282 \textcolor{comment}{//State.actualSpeed[1] = Spd2;}}

\end{DoxyCode}
